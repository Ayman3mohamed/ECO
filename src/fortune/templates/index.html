<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Oracle Fortune cookies</title>
    <style>

        body {
            background-color: bisque;
            -webkit-transition: background-color 3s;
            -moz-transition: background-color 3s;
            transition: background-color 3s;
        }

        .orImg {
            position: absolute;
            left: 50%;
            top: 40%;
            transform: translate3d(-50%,-50%,0);
            -webkit-transition: opacity 2s;
            -moz-transition: opacity 2s;
            transition: opacity 2s;
            width: 1000px;
        }

        #questForm {
            padding: 15px;
            position: absolute;
            left: 50%;
            bottom: 25%;
            transform: translate3d(-50%,50%,0);
            font-size: 18px;
            -webkit-transition: opacity 2s;
            -moz-transition: opacity 2s;
            transition: opacity 2s;
        }

        .formElem {
            font-size: 18px;
        }

        .buttonContainer{
            position: absolute;
            left:50%;
            transform: translateX(-50%);
            margin-top: 10px;
            width: 170px;
        }

        .input {
            width: 250px;
        }

        .gone {
            opacity: 0;
        }

        #response {
            position: absolute;
            left:50%;
            top: 50%;
            transform: translate3d(-50%,-50%,0);
            width= 600px;
            color: white;
            font-size: 30px;
            -webkit-transition: opacity 6s;
            -moz-transition: opacity 6s;
            transition: opacity 6s;
        }

    </style>
</head>
<body>
    <image src="static/oracle2.png" class="orImg letgo"></image>
    <script src="static/jquery-3.2.1.min.js"></script>

    <div id="questForm" class="letgo">
        <input type="text" name="text" class="formElem input" id="inputForm" autofocus="autofocus"><br>
        <div class="buttonContainer">
            <button value="callous" class="formElem" id="callous">callous</button>
            <button type="submit" value="care" class="formElem" id="care">care</button>
        </div>
    </div>

    <div id="response" class="gone">

    </div>

    <script>
        $("#callous").click(function(event){
            quest($("#inputForm").val(),'callous');
        });

        $("#care").click(function(event){
            quest($("#inputForm").val(),'care');
        });

        function quest(text, mode){
            $(".letgo").addClass('gone');
            $("body").css("background-color", "black");

            data = JSON.stringify({"text":text, "mode": mode});
            console.log(data);
            $.ajax({
              url: "/quest",
              type: 'POST',
              data : data,
              dataType: 'json',
              contentType: 'application/json',
              success: function(data){
                console.log(data);
                $("#response").removeClass('gone');
                $("#response").html(data['fortune'][0]);
                restore();
              },
              error: function(data){
                $("#response").removeClass('gone');
                $("#response").html("THE FUTURE IS UNKNOWN");
                restore();
              }
            });
        }

        restoreTime = 10000;

        function restore() {
            setTimeout(function(){
                $("#inputForm").val('')
                $(".letgo").removeClass('gone');
                $("body").css("background-color", "bisque");
                $("#response").addClass('gone');
                $("#response").html('');
                document.getElementById("inputForm").focus();
                //$("#inputForm").focus()
            },restoreTime)
        }
    </script>
</body>
</html>